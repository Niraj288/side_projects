import subprocess
import os

d={}
def save_coord(file,index):
	e={'14':'Si','1':'H','7':'N','8':'O','6':'C','53':'I','36':'Kr','9':'F'}
	li=[]
	ref=0
	for i in range (index,len(file)):
		#print file[i]
		if ref==3:
			break
		if '-------------' in file[i]:
			ref+=1
		elif ref==2:
			#print file[i]

			an=file[i].strip().split()[1]
			c=file[i].strip().split()[3:]
			li.append([e[an]]+[c])
	
	return li


def coord(path):
	file_o = open(path,'r')
	file=file_o.readlines()
	file_o.close()
	last=0.0
	index=0
	for line in file:
			
		if 'Standard orientation:' in line:
			last=save_coord(file,index)
			#print last
		index+=1
	return last 

def charge_value(string):	
	cords=string.strip().split('\n')
	x1,y1,z1=cords[0].split()
	x2,y2,z2=cords[1].split()


def func(path):
	filename=path.split('/')[-1].split('.')[0]
	s0='%chk='+filename+'.chk'
	s1="""
%nprocshared=4
%mem=10GB
#p opt=Z-Matrix Charge NoSymm b2plyp empiricaldispersion=gd3bj int=superfine pop=nbo  genecp freq output=wfx
"""
	s2='\n'+filename+'\n\n'
	s3=coord(path)+'\n\n'
	s4=charge_value(s3)+'\n'
	s5=""" 
I     0 
S   9   1.00
      5.546500E+03           1.560000E-04     
      8.382140E+02           9.860000E-04     
      1.821870E+02           2.792000E-03     
      3.121230E+01          -4.325100E-02     
      1.953140E+01           2.341340E-01     
      8.240990E+00          -7.509430E-01     
      2.194550E+00           8.829680E-01     
      1.109110E+00           4.620610E-01     
      8.106100E-02           1.102000E-03     
S   9   1.00
      5.546500E+03          -7.300000E-05     
      8.382140E+02          -5.080000E-04     
      1.821870E+02          -1.158000E-03     
      3.121230E+01           1.219300E-02     
      1.953140E+01          -8.785400E-02     
      8.240990E+00           3.382000E-01     
      2.194550E+00          -5.765500E-01     
      1.109110E+00          -4.092980E-01     
      8.106100E-02           1.432310E-01     
S   1   1.00
      3.746410E-01           1.0000000        
S   1   1.00
      1.770800E-01           1.0000000        
S   1   1.00
      1.001000E-01           1.0000000        
S   1   1.00
      4.120000E-02           1.0000000        
P   9   1.00
      1.889880E+02           5.850000E-04     
      2.128680E+01           3.692300E-02     
      1.003960E+01          -2.353240E-01     
      3.451800E+00           3.414830E-01     
      1.974560E+00           5.347880E-01     
      1.024200E+00           2.651410E-01     
      4.494370E-01           2.578700E-02     
      1.866480E-01           5.220000E-04     
      7.348100E-02           6.060000E-04     
P   9   1.00
      1.889880E+02          -2.560000E-04     
      2.128680E+01          -1.168200E-02     
      1.003960E+01           8.319200E-02     
      3.451800E+00          -1.569700E-01     
      1.974560E+00          -2.245180E-01     
      1.024200E+00          -1.144510E-01     
      4.494370E-01           3.753560E-01     
      1.866480E-01           5.751360E-01     
      7.348100E-02           2.459170E-01     
P   1   1.00
      5.981000E-01           1.0000000        
P   1   1.00
      9.618000E-02           1.0000000        
P   1   1.00
      3.590000E-02           1.0000000        
D   7   1.00
      1.326620E+02           5.720000E-04     
      3.760540E+01           4.402000E-03     
      1.038910E+01          -4.092200E-02     
      6.490170E+00           9.966100E-02     
      3.454510E+00           3.226630E-01     
      1.844130E+00           4.003430E-01     
      9.624780E-01           2.683060E-01     
D   1   1.00
      4.728530E-01           1.0000000        
D   1   1.00
      1.932000E-01           1.0000000        
D   1   1.00
      7.820000E-02           1.0000000        
F   1   1.00
      4.064000E-01           1.0000000        
F   1   1.00
      1.848000E-01           1.0000000        
****
Pt     0 
S   9   1.00
     36.0064000              0.0156030        
     22.4991000             -0.1396000        
     14.0609000              0.3994690        
      8.7816100             -0.1277440        
      4.9923800             -0.7514510        
      1.3838500              0.8633270        
      0.6616170              0.4975940        
      0.2048820              0.0347580        
      0.0922300             -0.0065890        
S   9   1.00
     36.0064000             -0.0056780        
     22.4991000              0.0507550        
     14.0609000             -0.1500300        
      8.7816100              0.0639820        
      4.9923800              0.2704110        
      1.3838500             -0.4346570        
      0.6616170             -0.3372900        
      0.2048820              0.2814460        
      0.0922300              0.6455790        
S   9   1.00
     36.0064000              0.0070370        
     22.4991000              0.0105250        
     14.0609000             -0.0854980        
      8.7816100             -0.1765590        
      4.9923800              0.8567070        
      1.3838500             -1.8442100        
      0.6616170              0.6011560        
      0.2048820              1.9822930        
      0.0922300             -1.1764800        
S   9   1.00
     36.0064000             -0.0114450        
     22.4991000              0.1220440        
     14.0609000             -0.3759060        
      8.7816100              0.0553880        
      4.9923800              1.1335870        
      1.3838500             -4.2149190        
      0.6616170              4.8759410        
      0.2048820             -2.1659360        
      0.0922300             -0.4268040        
S   1   1.00
      0.0392640              1.0000000        
S   1   1.00
      0.0167000              1.0000000        
P   8   1.00
     21.5986000             -0.0125150        
     13.5160000              0.0715700        
      5.9203700             -0.2872760        
      1.6412600              0.5154190        
      0.8311310              0.4804610        
      0.4084300              0.1679960        
      0.1754270              0.0158600        
      0.0726850              0.0007950        
P   8   1.00
     21.5986000              0.0029600        
     13.5160000             -0.0191100        
      5.9203700              0.0838980        
      1.6412600             -0.1830090        
      0.8311310             -0.1878840        
      0.4084300             -0.0017870        
      0.1754270              0.3606710        
      0.0726850              0.5449210        
P   8   1.00
     21.5986000              0.0067690        
     13.5160000             -0.0429400        
      5.9203700              0.1894550        
      1.6412600             -0.4606470        
      0.8311310             -0.4463350        
      0.4084300              0.4896840        
      0.1754270              0.6825880        
      0.0726850              0.1279470        
P   8   1.00
     21.5986000              0.0116510        
     13.5160000             -0.0715220        
      5.9203700              0.3259640        
      1.6412600             -1.2148310        
      0.8311310              0.1587270        
      0.4084300              1.5953330        
      0.1754270             -0.7779330        
      0.0726850             -0.5304420        
P   1   1.00
      0.0297610              1.0000000        
P   1   1.00
      0.0122000              1.0000000        
D   7   1.00
     72.7562000              0.0000520        
     10.4742000              0.0126260        
      6.2509000             -0.0632410        
      1.8018500              0.2396470        
      0.8884540              0.3876720        
      0.4156650              0.3517440        
      0.1830800              0.2052900        
D   7   1.00
     72.7562000             -0.0000370        
     10.4742000             -0.0157890        
      6.2509000              0.0782970        
      1.8018500             -0.3582960        
      0.8884540             -0.4793250        
      0.4156650              0.1884070        
      0.1830800              0.5781450        
D   7   1.00
     72.7562000             -0.0000260        
     10.4742000              0.0271890        
      6.2509000             -0.1307380        
      1.8018500              0.8378570        
      0.8884540              0.0073940        
      0.4156650             -1.0612590        
      0.1830800              0.2490050        
D   1   1.00
      0.0742330              1.0000000        
D   1   1.00
      0.0301000              1.0000000        
F   1   1.00
      1.3040000              1.0000000        
F   1   1.00
      0.4337000              1.0000000        
F   1   1.00
      0.1662000              1.0000000        
G   1   1.00
      1.0772000              1.0000000        
G   1   1.00
      0.4643000              1.0000000        
****

I     0
I-ECP     4     28
g-ul potential
  1
2      1.00000000             0.00000000       
s-ul potential
  3
2     40.03337600            49.98964900       
2     17.30057600           281.00655600       
2      8.85172000            61.41673900       
p-ul potential
  4
2     15.72014100            67.41623900       
2     15.20822200           134.80769600       
2      8.29418600            14.56654800       
2      7.75394900            28.96842200       
d-ul potential
  4
2     13.81775100            35.53875600       
2     13.58780500            53.33975900       
2      6.94763000             9.71646600       
2      6.96009900            14.97750000       
f-ul potential
  4
2     18.52295000           -20.17661800       
2     18.25103500           -26.08807700       
2      7.55790100            -0.22043400       
2      7.59740400            -0.22164600       
PT     0
PT-ECP     5     60
h-ul potential
  1
2      1.00000000             0.00000000       
s-ul potential
  2
2     14.60450000           429.64608700       
2      7.21828700            73.15688400       
p-ul potential
  4
2     11.57716200            88.02291700       
2     10.88384300           175.99819600       
2      6.42440300            13.68227400       
2      5.22419800            27.41465100       
d-ul potential
  4
2      7.69961000            43.55785200       
2      7.55080800            65.36910800       
2      3.96116400             7.01859600       
2      3.87277700            11.39173300       
f-ul potential
  2
2      3.37986900            10.71022000       
2      3.32625500            14.27812500       
g-ul potential
  2
2      5.45202000           -11.65174900       
2      5.41258500           -14.37552500 

"""
	return s0+s1+s2+s3+s4

def job():
	path=raw_input('Enter path : ')
	ref=raw_input('Make all .g16.out files ?? (y/n) : ')
	li=[]
	for i in os.listdir(path):
		if '.g16.out'==i[-8:]:
			if ref=='y' or raw_input('Is the file '+i+' an input ?? (y/n) : ')=='y':
				filename=i.split('.')[0]
				f=open(filename+'.orca','w')
				f.write(func(i))
				f.close()
				li.append(filename+'.orca')




job()